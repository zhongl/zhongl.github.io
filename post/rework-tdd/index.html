<!DOCTYPE html><html lang="zh-CN"><head><title>é‡æ¥TDD</title><meta charset="utf-8" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="ç¼–è¯‘å™¨å¯èƒ½æ˜¯æœ€å®¹æ˜“è¢«é—å¿˜çš„æµ‹è¯•åˆ©å™¨ã€‚" /><meta name="viewport" content="width=device-width" /><link rel="stylesheet" type="text/css" href="/style.css" /><link rel="apple-touch-icon" size="180x180" href="/apple-touch-icon.png" /><link rel="icon" type="image/png" size="32x32" href="/favicon-32x32.png" /><link rel="icon" type="image/png" size="16x16" href="/favicon-16x16.png" /><link rel="manifest" href="/site.webmanifest" /><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-REFRQT9XHR"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-REFRQT9XHR');
</script></head><body><main><menu><div><a href="/post/">ğš²</a></div></menu><article><header><time datetime="2024-10-22">Oct 22, 2024</time><h1>é‡æ¥TDD</h1></header><div class="lead">
<p>ç¼–è¯‘å™¨å¯èƒ½æ˜¯æœ€å®¹æ˜“è¢«é—å¿˜çš„æµ‹è¯•åˆ©å™¨ã€‚</p>
</div>
<figure>
<img src="3b0f78589d8c5c84e92aca7766a17192328da2de.png"
alt="å›¾ç‰‡æ¥è‡ªç½‘ç»œ" />
<figcaption aria-hidden="true">å›¾ç‰‡æ¥è‡ªç½‘ç»œ<a href="#fn1"
class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a></figcaption>
</figure>
<p>åŸæœ¬è®¡åˆ’ç€å†™ä¸€ä¸ªè¯é¢˜å«ï¼Œâ€œæœ€è¿‘æˆ‘æ€ä¹ˆä¸å†™æµ‹è¯•ç”¨ä¾‹å•¦â€ï¼Ÿæ²¡æˆæƒ³ï¼Œè¿™å‘ä¸€æŒ–ï¼ŒæŠŠè‡ªå·±é™·è¿›å»äº†ã€‚å†ä¸åœä¸€åœçš„è¯ï¼Œæ€•æ˜¯æˆ‘è¦çˆ¬ä¸å‡ºæ¥äº†ã€‚</p>
<p>è™½ä¸æ•¢è¯´è‡ªå·±æ˜¯ TDDï¼ˆTest-Driven Developmentï¼‰<a href="#fn2"
class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
çš„ç‹‚çƒ­ä¿¡å¾’ï¼Œä½†è‡³å°‘æˆ‘æ˜¯ä¸€ç›´åœ¨ç”¨ç¼–ç¨‹æµ‹è¯•ç”¨ä¾‹æ¥ä¸ºå¼€å‘çš„ä»£ç ä¿é©¾æŠ¤èˆªçš„ã€‚ä¸æˆ‘å…±äº‹è¿‡çš„æœ‹å‹åº”è¯¥éƒ½è¿˜è®°å¾—ï¼Œæˆ‘çŠ¯æµ‹è¯•è¦†ç›–å¼ºè¿«ç—‡æ—¶çš„æ ·å­ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘è¦æ¥èŠå¦ä¸€ä¸ªåæ°”æ²¡é‚£ä¹ˆå¤§çš„ TDDï¼ˆType-Driven
Developmentï¼‰ã€‚è¯¶ï¼Œåˆ«æ€¥ç€èµ°ï¼Œå¦‚æœä½ æ˜¯å¯¹é«˜è´¨é‡ä»£ç æ„Ÿå…´è¶£çš„è¯ï¼Œè¿™ä¸ª TDD
æ˜¯ä¸ä¼šè®©ä½ å¤±æœ›çš„ï¼Œç›¸ä¿¡æˆ‘ã€‚</p>
<p>ä»ä¸šæ—©å¹´ï¼Œå¬åŠé—´ä¼ é—»ï¼Œâ€œæŸè¯­è¨€åªè¦ç¼–è¯‘é€šè¿‡äº†ï¼Œå°±æ²¡æœ‰BUGâ€ã€‚å¾ˆé•¿æ—¶é—´é‡Œï¼Œæˆ‘ä¸å¾—ç”šè§£ï¼Œä½†å¤§å—éœ‡æ’¼ã€‚ç›´åˆ°æœ€è¿‘ï¼Œæˆ‘æœ‰äº†ä¸€ç‚¹å°å°çš„æ”¶è·ï¼Œé‚æ‹¿ä¸ªå°ä¾‹å­ä¸å¤§å®¶ä¼—ä¹ä¸€ç•ªã€‚</p>
<p>è¿™ä¸ªä¾‹å­æºè‡ªã€ŒType-Driven Development with Idrisã€ä¸€ä¹¦<a href="#fn3"
class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a>ï¼Œåªä¸è¿‡æˆ‘æ˜¯ä» Scala çš„è§†è§’æ¥è§£è¯» <a
href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a>ï¼Œæ¥ä¸‹æ¥è¨€å½’æ­£ä¼ ã€‚</p>
<h2 id="printf">Printf</h2>
<div class="sourceCode" id="cb1"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">,</span> <span class="dv">23</span><span class="op">)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>age<span class="op">:</span> <span class="dv">23</span></span></code></pre></div>
<p>è¿™æ˜¯ä¸€ä¸ªå†å¸¸è§ä¸è¿‡çš„æ‰“å°è¾“å‡ºå‡½æ•°äº†ï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡ç‰ˆ
<code>age %d</code>ï¼Œåé¢çš„å‚æ•° <code>23</code> ä¼šæ›¿æ¢æ‰æ¨¡ç‰ˆä¸­çš„å ä½ç¬¦
<code>%d</code>ï¼Œä»è€Œæ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>ä¸åŒçš„å ä½ç¬¦å¯¹å…¶å‚æ•°çš„ç±»å‹æ˜¯å…¶å®æ˜¯æœ‰é¢„æœŸçš„ <a href="#fn5"
class="footnote-ref" id="fnref5"
role="doc-noteref"><sup>5</sup></a>ã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™æ— æ³•ä½“ç°åœ¨å‡½æ•°çš„ç±»å‹å£°æ˜ä¸Šã€‚</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="op">:</span><span class="kw">type</span> <span class="fu">printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">,</span> _<span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Seq</span><span class="op">[</span><span class="ex">Any</span><span class="op">]</span> <span class="op">=&gt;</span> <span class="bu">Unit</span></span></code></pre></div>
<p>å³ï¼Œç¬¬äºŒå‚æ•°ç±»å‹æ˜¯ä»»æ„å€¼çš„åºåˆ—ã€‚ä¹Ÿå°±æ„å‘³ç€ï¼Œç¼–è¯‘å™¨å¯¹è¿™ç§ç±»å‹çš„é”™é…ï¼Œæ— èƒ½ä¸ºåŠ›ã€‚</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">,</span> <span class="st">&quot;john&quot;</span><span class="op">)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>java<span class="op">.</span>util<span class="op">.</span><span class="ex">IllegalFormatConversionException</span><span class="op">:</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  d <span class="op">!=</span> java<span class="op">.</span>lang<span class="op">.</span><span class="ex">String</span></span></code></pre></div>
<p>ç¼–è¯‘å™¨çœŸçš„æ— èƒ½ä¸ºåŠ›å—ï¼Ÿæˆ‘å°è¯•å®ç°ä¸€ä¸ªç±»å‹å®‰å…¨çš„
<code>Printf</code>ï¼Œçœ‹çœ‹æ•ˆæœå…ˆã€‚</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="op">:</span><span class="kw">type</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">)(</span>_<span class="op">)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Unit</span></span></code></pre></div>
<p>è¯•ç€çŠ¯å¦‚ä¸Šçš„é”™è¯¯ï¼Œ</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">)(</span><span class="st">&quot;john&quot;</span><span class="op">)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> <span class="op">[</span>E007<span class="op">]</span> <span class="ex">Type</span> Mismatch <span class="ex">Error</span><span class="op">:</span> <span class="op">--</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">|</span><span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">)(</span><span class="st">&quot;john&quot;</span><span class="op">)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>                  <span class="op">^^^^^^</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> Found<span class="op">:</span>    <span class="op">(</span><span class="st">&quot;john&quot;</span> <span class="op">:</span> <span class="ex">String</span><span class="op">)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> Required<span class="op">:</span> <span class="bu">Int</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> error found</span></code></pre></div>
<p>æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿå…·ä½“çš„è¯­è¨€æŠ€å·§æ”¾åœ¨åé¢å†è®²ï¼Œå…ˆæ¥ç†æ¸…æ€è·¯ã€‚</p>
<p>é¦–å…ˆï¼Œè¦èƒ½åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå®ç°å¯¹æ¨¡ç‰ˆä¸­å­˜åœ¨çš„å ä½ç¬¦çš„è§£æï¼Œè¿™æ˜¯å‚æ•°ç±»å‹æ¨å¯¼çš„å‰æï¼Œè¿™ä¹Ÿæ˜¯æœ€å®¹æ˜“æƒ³åˆ°çš„ã€‚</p>
<p>å…¶æ¬¡ï¼Œè¿™é‡Œçš„å‚æ•°åˆ—è¡¨æ˜¯ <strong>å¯å˜</strong> çš„ï¼Œä¸”
<strong>ç±»å‹ä¸å°½ç›¸åŒ</strong> ã€‚ç”¨ä»¥è¡¨è¾¾çš„ç±»å‹è‚¯å®šä¸èƒ½æ˜¯
<code>Array[A]</code>ï¼Œ<code>Seq[A]</code> å’Œ <code>List[A]</code>ã€‚
è²Œä¼¼åªæœ‰ <code>Tuple2[A, B]</code>ï¼Œ <code>Tuple3[A, B, C]</code>
ç­‰ç­‰ã€‚å¯æƒœï¼Œå®ƒä»¬æ˜¯å›ºå®šé•¿åº¦çš„ï¼Œæ»¡è¶³ä¸äº†å¯å˜çš„è¦æ±‚ã€‚</p>
<p>çœŸçš„å—ï¼Ÿæˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œï¼Œå¯æ˜¯æåˆ°äº† Scala3 ä¸­æœ‰å…³ <code>Tuple</code>
çš„æ–°ç‰¹æ€§ï¼Œæ­£å¥½åº”å¯¹è¿™é‡Œçš„éœ€æ±‚ã€‚</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="op">:</span><span class="kw">type</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;no placeholder&quot;</span><span class="op">)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>EmptyTuple <span class="op">=&gt;</span> <span class="bu">Unit</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="op">:</span><span class="kw">type</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;age: %d&quot;</span><span class="op">)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Int</span> <span class="op">*:</span> EmptyTuple <span class="op">=&gt;</span> <span class="bu">Unit</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="op">:</span><span class="kw">type</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;name: %s, age: %d&quot;</span><span class="op">)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ex">String</span><span class="op">,</span> <span class="bu">Int</span><span class="op">)</span> <span class="op">=&gt;</span> <span class="bu">Unit</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">// (String, Int) =:= String *: Int *: EmptyTuple</span></span></code></pre></div>
<p>çœ‹å‡ºè§„å¾‹äº†å§ï¼Œå¯å˜çš„å‚æ•°ç±»å‹å¯ä»¥é€šè¿‡ <code>*:</code> å’Œ
<code>EmptyTuple</code> è¡”æ¥æ¥å®ç°ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹è¦æ€ä¹ˆå®ç°ç¼–è¯‘æœŸçš„å­—ç¬¦ä¸²è§£æã€‚Scala3 æä¾›äº†
<strong>Match Types</strong> <a href="#fn6" class="footnote-ref"
id="fnref6" role="doc-noteref"><sup>6</sup></a> å¯ä»¥åšåˆ°ã€‚</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">type</span> IsA<span class="op">[</span>S<span class="op">]</span> <span class="op">&lt;:</span> <span class="ex">Boolean</span> <span class="op">=</span> S <span class="cf">match</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> <span class="st">&quot;A&quot;</span> <span class="op">=&gt;</span> <span class="kw">true</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> _   <span class="op">=&gt;</span> <span class="kw">false</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> summon<span class="op">[</span>IsA<span class="op">[</span><span class="st">&quot;A&quot;</span><span class="op">]</span> <span class="op">=:=</span> <span class="kw">true</span><span class="op">]</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> res1<span class="op">:</span> <span class="kw">true</span> <span class="op">=:=</span> <span class="kw">true</span> <span class="op">=</span> generalized constraint</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> summon<span class="op">[</span>IsA<span class="op">[</span><span class="st">&quot;&quot;</span><span class="op">]</span> <span class="op">=:=</span> <span class="kw">false</span><span class="op">]</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> res2<span class="op">:</span> <span class="kw">false</span> <span class="op">=:=</span> <span class="kw">false</span> <span class="op">=</span> generalized constraint</span></code></pre></div>
<p><code>IsA[S]</code> å®šä¹‰äº†å¯¹ç±»å‹å‚æ•° <code>S</code>
çš„åŒ¹é…æ¨¡å¼ã€‚å³ï¼Œå½“ä¸º <code>"A"</code> æ—¶ï¼Œ<code>IsA["A"]</code>
çš„çœŸæ­£ç±»å‹æ˜¯ <code>true</code>ã€‚</p>
<p>å¯¹äº <code>"A"</code> æ˜¯ç±»å‹è¡¨ç¤ºé™Œç”Ÿçš„æœ‹å‹ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹çŸ¥è¯†ç‚¹
<strong>Literal Types</strong> <a href="#fn7" class="footnote-ref"
id="fnref7"
role="doc-noteref"><sup>7</sup></a>ã€‚è¿™é‡Œå¤šå¾—ä¸è¯´äº†ï¼Œçœ‹ä¸‹é¢å‡ è¡Œä½“ä¼šä½“ä¼šã€‚</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> a<span class="op">:</span> <span class="st">&quot;A&quot;</span> <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> a<span class="op">:</span> <span class="st">&quot;A&quot;</span> <span class="op">=</span> A</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> a<span class="op">:</span> <span class="st">&quot;B&quot;</span> <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> <span class="op">[</span>E007<span class="op">]</span> <span class="ex">Type</span> Mismatch <span class="ex">Error</span><span class="op">:</span> <span class="op">--</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">|</span><span class="kw">val</span> a<span class="op">:</span> <span class="st">&quot;B&quot;</span> <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>             <span class="op">^^^</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>Found<span class="op">:</span>    <span class="op">(</span><span class="st">&quot;A&quot;</span> <span class="op">:</span> <span class="ex">String</span><span class="op">)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>Required<span class="op">:</span> <span class="op">(</span><span class="st">&quot;B&quot;</span> <span class="op">:</span> <span class="ex">String</span><span class="op">)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> error found</span></code></pre></div>
<p>è¯´å›æ¥ï¼Œæœ‰äº† <strong>Match Types</strong> å’Œ <strong>Literal
Types</strong> ï¼Œå°±å·®å­—ç¬¦ä¸²çš„æ“ä½œäº†</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> summon<span class="op">[</span>CharAt<span class="op">[</span><span class="st">&quot;age&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">]</span> <span class="op">=:=</span> <span class="ch">&#39;a&#39;</span><span class="op">]</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> res3<span class="op">:</span> a <span class="op">=:=</span> a <span class="op">=</span> generalized constraint</span></code></pre></div>
<p>åƒ <code>CharAt</code> ç­‰ç±»ä¼¼å­—ç¬¦ä¸²æ“ä½œçš„å‡½æ•°ï¼ŒScala
æ ‡å‡†åº“éƒ½æä¾›äº†å¯¹åº”çš„ <strong>Match Types</strong> <a href="#fn8"
class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>ã€‚
ä½™ä¸‹çš„ï¼Œæˆ‘æƒ³ä½ å¤§æ¦‚å¯ä»¥è„‘è¡¥äº†ï¼Œè‡ªå·±åŠ¨æ‰‹å°è¯•ä¸€ä¸‹å§ï¼Œä¹è¶£æ»¡æ»¡ã€‚</p>
<p>åˆ°è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç‘•ç–µï¼Œå¦‚ä¸‹</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;no placeholder&quot;</span><span class="op">)()</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> <span class="op">[</span>E171<span class="op">]</span> <span class="ex">Type</span> <span class="ex">Error</span><span class="op">:</span> <span class="op">----------------------</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">|</span><span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;no placeholder&quot;</span><span class="op">)()</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">|^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>missing argument <span class="cf">for</span> parameter v1 </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>of method apply in </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span><span class="kw">trait</span> Function1<span class="op">:</span> <span class="op">(</span>v1<span class="op">:</span> EmptyTuple<span class="op">):</span> <span class="bu">Unit</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> error found</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">Printf</span><span class="op">(</span><span class="st">&quot;no placeholder&quot;</span><span class="op">)(</span>EmptyTuple<span class="op">)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>no placeholder</span></code></pre></div>
<p><code>Tuple</code> ç±»å‹å¸¦æ¥å‚æ•°è¾“å…¥çš„ä¸ä¾¿ï¼Œå°¤å…¶åœ¨å‚æ•°æ•°é‡ä¸º
<code>0</code> å’Œ <code>1</code>
çš„æ—¶å€™ã€‚è§£å†³åŠæ³•ï¼Œæˆ‘è¿™é‡Œæä¾›ä¸€ä¸ªæ€è·¯ã€‚</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> Args<span class="op">[</span>S<span class="op">]</span> <span class="op">&lt;:</span> Tuple <span class="op">=</span> <span class="op">???</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">trait</span> <span class="ex">Result</span><span class="op">[</span>T <span class="op">&lt;:</span> Tuple<span class="op">]:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">type</span> Out</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">apply</span><span class="op">(</span>pattern<span class="op">:</span> <span class="ex">String</span><span class="op">):</span> Out</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>given string<span class="op">:</span> <span class="ex">Result</span><span class="op">[</span>EmptyTuple<span class="op">]</span> <span class="kw">with</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">type</span> Out <span class="op">=</span> <span class="bu">Unit</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">apply</span><span class="op">(</span>pattern<span class="op">:</span> <span class="ex">String</span><span class="op">):</span> Out <span class="op">=</span> <span class="fu">print</span><span class="op">(</span>pattern<span class="op">)</span></span></code></pre></div>
<p>å‡å®šï¼Œ<code>Arg[S]</code>
å®ç°äº†å¯¹æ¨¡ç‰ˆå ä½ç¬¦çš„è§£æï¼Œå¹¶æ¨å¯¼å‡ºå‚æ•°åˆ—è¡¨ç±»å‹ <code>Tuple</code>ã€‚</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> Printf<span class="op">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">apply</span><span class="op">(</span>s<span class="op">:</span> <span class="ex">String</span><span class="op">)(</span>using </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    r<span class="op">:</span> <span class="ex">Result</span><span class="op">[</span>Args<span class="op">[</span>s<span class="op">.</span><span class="kw">type</span><span class="op">]]</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">):</span> r<span class="op">.</span>Out <span class="op">=</span> <span class="fu">r</span><span class="op">(</span>s<span class="op">)</span></span></code></pre></div>
<p>é‚£ä¹ˆï¼Œå½“ <code>Tuple</code> ä¸åŒæ—¶ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„
<code>Result[T &lt;: Tuple]</code> æ´¾ç”Ÿæ¥åº”å¯¹ <a href="#fn9"
class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>ã€‚
å®Œæ•´çš„ä»£ç å¯é˜…è¯»åŸæ–‡æˆ–å‚è§è„šæ³¨é“¾æ¥æŸ¥é˜… <a href="#fn10"
class="footnote-ref" id="fnref10"
role="doc-noteref"><sup>10</sup></a>ã€‚</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å®äº‹æ±‚æ˜¯ï¼Œä»…å°± <code>Printf</code>
è¿™æ ·çš„ç±»å‹å®‰å…¨æŠ¤æ ä¸ªæ¡ˆï¼Œåªæ˜¯èœ»èœ“ç‚¹æ°´ï¼Œå¯¹äºæå‡å…¨å±€å·¥ç¨‹è´¨é‡è€Œè¨€ï¼Œå¯èƒ½æ˜¯æ— è¶³æŒ‚é½¿çš„ã€‚
ä½†é‡è¦çš„æ˜¯ï¼Œç±»å‹é©±åŠ¨å¼€å‘çš„æ€ç»´æ–¹å¼ï¼Œèµ°åœ¨äº†æµ‹è¯•å…ˆè¡Œçš„æ›´å‰é¢ã€‚å®ƒèƒ½è®©ç¼–è¯‘å™¨æ›´æ‡‚ä¸šåŠ¡é€»è¾‘ï¼Œå‰ææ˜¯æˆ‘ä»¬å¯¹ç±»å‹çš„æ€è€ƒçœŸæ­£çš„æ”¾åœ¨ä¸šåŠ¡çš„å±‚é¢ã€‚</p>
<p>PSï¼šè‹¥è§‰å¾—ä»¥ä¸Šå†…å®¹è¿˜ä¸é”™ï¼Œè¿˜è¯·è®°å¾—è½¬å‘åˆ†äº«ç»™ä½ çš„åŒäº‹æˆ–åŒè¡Œï¼Œè¿™å¯¹æˆ‘æœ€å¤§çš„é¼“åŠ±ã€‚</p>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a
href="https://www.letsmakebettersoftware.com/2017/09/test-driven-development-tdd.html"
class="uri"
target="_blank">https://www.letsmakebettersoftware.com/2017/09/test-driven-development-tdd.html</a><a
href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p><a
href="https://en.wikipedia.org/wiki/Test-driven_development" class="uri"
target="_blank">https://en.wikipedia.org/wiki/Test-driven_development</a><a
href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p><a
href="https://www.manning.com/books/type-driven-development-with-idris"
class="uri"
target="_blank">https://www.manning.com/books/type-driven-development-with-idris</a><a
href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>é¡ºå¸¦æ¼”ç¤ºä¸€äº› Scala3 çš„æ–°ç‰¹æ€§ã€‚<a href="#fnref4"
class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn5"><p><a
href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/Formatter.html"
class="uri"
target="_blank">https://docs.oracle.com/javase/8/docs/api/index.html?java/util/Formatter.html</a><a
href="#fnref5" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn6"><p><a
href="https://docs.scala-lang.org/scala3/reference/new-types/match-types.html"
class="uri"
target="_blank">https://docs.scala-lang.org/scala3/reference/new-types/match-types.html</a><a
href="#fnref6" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn7"><p><a
href="https://medium.com/@hao.qin/scala-3-enlightenment-unleash-the-power-of-literal-types-41e3436b4df8"
class="uri"
target="_blank">https://medium.com/@hao.qin/scala-3-enlightenment-unleash-the-power-of-literal-types-41e3436b4df8</a><a
href="#fnref7" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn8"><p><a
href="https://www.scala-lang.org/api/current/scala/compiletime/ops/string$.html#Types"
class="uri"
target="_blank">https://www.scala-lang.org/api/current/scala/compiletime/ops/string$.html#Types</a><a
href="#fnref8" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn9"><p><a
href="https://docs.scala-lang.org/scala3/book/types-dependent-function.html"
class="uri"
target="_blank">https://docs.scala-lang.org/scala3/book/types-dependent-function.html</a><a
href="#fnref9" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn10"><p><a
href="https://github.com/zhongl/type-driven-development-with-scala3/blob/main/ch06/printf.worksheet.sc"
class="uri"
target="_blank">https://github.com/zhongl/type-driven-development-with-scala3/blob/main/ch06/printf.worksheet.sc</a><a
href="#fnref10" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol>
</section>
<nav class="not-prose"><ul><li><a href="/post/#/plog"><span class="icons-outlined align-bottom">tag</span>ç å¿—</a></li></ul></nav><img class="mx-auto size-80 grayscale" src="/qrcode_wechat.jpg" /></article><footer><p><span>Â©</span>2025 zhongl.fun</p></footer></main></body></html>