<!DOCTYPE html><html lang="zh-CN"><head><title>ç”¨ç±»å‹çœ‹é€ Y Combinator</title><meta charset="utf-8" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="å½“ f(x) = x ï¼Œç§°æ­¤æ—¶çš„ x ä¸ºå‡½æ•° f çš„å›ºå®šç‚¹ï¼ˆFixed Pointï¼‰ã€‚å¦‚æœ x æ˜¯ä¸€ä¸ªå‡½æ•°å‘¢ï¼Ÿ" /><meta name="viewport" content="width=device-width" /><link rel="stylesheet" type="text/css" href="/style.css" /><link rel="apple-touch-icon" size="180x180" href="/apple-touch-icon.png" /><link rel="icon" type="image/png" size="32x32" href="/favicon-32x32.png" /><link rel="icon" type="image/png" size="16x16" href="/favicon-16x16.png" /><link rel="manifest" href="/site.webmanifest" /><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-REFRQT9XHR"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-REFRQT9XHR');
</script></head><body><main><menu><div><a href="/post/">ğš²</a></div></menu><article><header><time datetime="2024-11-08">Nov 8, 2024</time><h1>ç”¨ç±»å‹çœ‹é€ Y Combinator</h1></header><div class="lead">
<p>å½“ <span
class="math inline"><em>f</em>(<em>x</em>)â€„=â€„<em>x</em></span>
ï¼Œç§°æ­¤æ—¶çš„ <span class="math inline"><em>x</em></span> ä¸ºå‡½æ•° <span
class="math inline"><em>f</em></span> çš„å›ºå®šç‚¹ï¼ˆFixed Pointï¼‰ã€‚å¦‚æœ
<span class="math inline"><em>x</em></span> æ˜¯ä¸€ä¸ªå‡½æ•°å‘¢ï¼Ÿ</p>
</div>
<figure>
<img src="0-b36ffbbc96d61d8e3c4c022e1014b3781f57368a.png"
alt="Fixed Point Combinator" />
<figcaption aria-hidden="true">Fixed Point Combinator</figcaption>
</figure>
<p>â€œä¸å°±æ˜¯ Y Combinator å˜›ï¼Œ æˆ‘çŸ¥é“â€ <a href="#fn1" class="footnote-ref"
id="fnref1" role="doc-noteref"><sup>1</sup></a>ã€‚</p>
<p>å—¯ï¼Œä»‹ç»å®ƒçš„æ–‡ç« ç¡®å®ä¸å°‘ï¼Œä½†å®¹æ˜“çœ‹æ‡‚çš„åº”è¯¥ä¸å¤šã€‚è¿™æ¬¡ï¼Œæˆ‘å¦è¾Ÿè¹Šå¾„ï¼Œå°è¯•ä»ç±»å‹çš„è§†è§’æ¥å‰–æ
Y Combinator ï¼Œçœ‹èƒ½å¦è®©äººè±ç„¶å¼€æœ—ã€‚</p>
<p>å›é¡¾ä¸€ä¸‹ Y Combinator çš„æ— ç±»å‹ Lambda
æ¼”ç®—è¡¨è¾¾å¼ï¼Œå¦‚ä¸‹ï¼ˆæ­¤åä¸å†æœ‰æ›´å¤šå…¬å¼ï¼‰ï¼š</p>
<figure>
<img src="3ab02b08bce098422460cb7ee64a0460b502ed71.png"
alt="Y Combinator" />
<figcaption aria-hidden="true">Y Combinator</figcaption>
</figure>
<p>ä¸å–å…³å­ï¼Œç›´æ¥ä¸Šç¿»è¯‘åçš„ Scala ä»£ç ï¼š</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> F<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> A <span class="op">=&gt;</span> A</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">trait</span> X<span class="op">[</span>A<span class="op">]</span> <span class="kw">extends</span> <span class="op">(</span>X<span class="op">[</span>A<span class="op">]</span> <span class="op">=&gt;</span> F<span class="op">[</span>A<span class="op">])</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Y<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> F<span class="op">[</span>A<span class="op">]</span> <span class="op">=&gt;</span> F<span class="op">[</span>A<span class="op">]):</span> F<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">val</span> g<span class="op">:</span> X<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> x <span class="op">=&gt;</span> a <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))(</span>a<span class="op">)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">g</span><span class="op">(</span>g<span class="op">)</span></span></code></pre></div>
<p>ç§’æ‡‚çš„æœ‹å‹ï¼Œå¯ç•¥è¿‡åæ–‡äº†ï¼Œè‹¥æ„Ÿå…´è¶£éªŒè¯ä¸€ä¸‹ä»£ç çš„è¯·å‚é˜…è„šæ³¨ <a
href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a>ã€‚ç•™ä¸‹çš„æœ‹å‹ï¼Œè¯·ç»§ç»­è·Ÿæˆ‘æ¥ã€‚</p>
<h2 id="ç ´é™¤é˜…è¯»éšœç¢">ç ´é™¤é˜…è¯»éšœç¢</h2>
<p>çœ‹ä¸æ‡‚ Y Combinator çš„åŸå› ï¼Œå¤§æ¦‚ç‡æ˜¯å› ä¸ºçœ‹ä¸æ‡‚ï¼ˆæ— ç±»å‹çš„ï¼‰ Lambda
æ¼”ç®—è¯­æ³•ã€‚ä¸ºæ–¹ä¾¿åæ–‡ç†è§£ï¼Œä»¥ä¸‹è¯­æ³•ç¿»è¯‘å°æŠ„è¯·è®°ç‰¢ï¼š</p>
<ul>
<li><code>Î»x.x</code>ï¼Œå³ <code>x =&gt; x</code>ï¼Œå®šä¹‰åŒ¿åå‡½æ•°;</li>
<li><code>f x</code>ï¼Œå³ <code>f(x)</code>ï¼Œåº”ç”¨å‡½æ•°ï¼›</li>
</ul>
<p>é‚£ä¹ˆï¼ŒY Combinator è‹¥ç¿»è¯‘æˆ Javascript å°±æ˜¯ <a href="#fn3"
class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a>ï¼š</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Y <span class="op">=</span> f <span class="kw">=&gt;</span> (x <span class="kw">=&gt;</span> <span class="fu">f</span>(<span class="fu">x</span>(x)))(x <span class="kw">=&gt;</span> <span class="fu">f</span>(<span class="fu">x</span>(x)))</span></code></pre></div>
<h2 id="è‡ªåº”ç”¨å‡½æ•°-sa">è‡ªåº”ç”¨å‡½æ•° <a href="#fn4" class="footnote-ref"
id="fnref4" role="doc-noteref"><sup>4</sup></a></h2>
<p><code>Y</code> æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¾ˆéš¾åˆ¤æ–­ã€‚ä¸å¦¨ä» <code>f</code> å’Œ
<code>x</code> è¿™ä¸¤ä¸ªç›¸å¯¹ç®€å•çš„å‡½æ•°å…¥æ‰‹å…ˆã€‚å‡å®šï¼Œ<code>f</code> çš„ç±»å‹ä¸º
<code>F</code>ï¼Œå‚æ•°å’Œè¿”å›å€¼ç±»å‹ä¸è¯¦ï¼Œæš‚ä¸”ç”¨ <code>Any</code> è¡¨ç¤ºï¼š</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">type</span> F <span class="op">=</span> <span class="ex">Any</span> <span class="op">=&gt;</span> <span class="ex">Any</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">// defined alias type F = Any =&gt; Any</span></span></code></pre></div>
<p><code>x</code> çš„ç±»å‹ <code>X</code> å°±æœ‰ç‚¹è®©äººæŒ å¤´äº†ï¼Œå®ƒ
<strong>è‡ªå·± ä¾èµ– è‡ªèº« ä½œä¸ºå‚æ•°</strong>ã€‚ç¡¬ç€å¤´çš®å¯ä»¥è¿™ä¹ˆå£°æ˜ï¼š</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">type</span> X <span class="op">=</span> X <span class="op">=&gt;</span> <span class="ex">Any</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> <span class="op">[</span>E140<span class="op">]</span> Cyclic <span class="ex">Error</span><span class="op">:</span> <span class="op">------------</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">|</span><span class="kw">type</span> X <span class="op">=</span> X <span class="op">=&gt;</span> <span class="ex">Any</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>     <span class="op">^</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>illegal cyclic <span class="kw">type</span> reference<span class="op">:</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>  alias X <span class="op">=&gt;</span> <span class="ex">Any</span> of <span class="kw">type</span> X refers</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span>  back to the <span class="kw">type</span> itself</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> error found</span></code></pre></div>
<p>æ„æ€æ˜¯è¿™ä¹ˆä¸ªæ„æ€ï¼Œå¯æƒœç¼–è¯‘å™¨ä¸æ¥å—è¿™æ ·çš„ç±»å‹åˆ«åï¼ˆaliasï¼‰å£°æ˜ã€‚ç¼–è¯‘å™¨å¯æ¥å—çš„ç­‰ä»·å½¢å¼æ˜¯è¿™æ ·çš„ï¼š</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">trait</span> X <span class="kw">extends</span> <span class="op">(</span>X <span class="op">=&gt;</span> <span class="ex">Any</span><span class="op">)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">// defined trait X</span></span></code></pre></div>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å°† Y Combinator ç¿»è¯‘æˆ Scalaï¼Œæ¥çœ‹çœ‹ <code>Y</code>
çš„ç±»å‹ï¼š</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">def</span> <span class="fu">Y</span><span class="op">(</span>f<span class="op">:</span> F<span class="op">)</span> <span class="op">=</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="kw">val</span> g<span class="op">:</span> X <span class="op">=</span> x <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="fu">g</span><span class="op">(</span>g<span class="op">)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">Y</span><span class="op">(</span>f<span class="op">:</span> F<span class="op">):</span> <span class="ex">Any</span></span></code></pre></div>
<p>å…¶ä¸­çš„ <code>g</code> ç›¸å½“äºç»™åé¢ <code>X</code>
çš„è¡¨è¾¾å¼èµ·äº†ä¸ªåˆ«åï¼Œè¿™æ ·ä»£ç çœ‹ç€æ›´ç®€æ´ã€‚æœ€åä¸€è¡Œï¼Œç¼–è¯‘å™¨å·²ç»æ¨æ–­å‡º
<code>Y</code> çš„å®Œæ•´ç±»å‹è¡¨è¾¾äº†ã€‚</p>
<p>æ³¨æ„ï¼Œæ ¹æ® <code>f(x(x))</code>ï¼Œå¯çŸ¥ <code>x</code> çš„è¿”å›å€¼æ˜¯è¦ä½œä¸º
<code>f</code> çš„å‚æ•°çš„ï¼Œè¿™äºŒè€…çš„ç±»å‹å¿…ç„¶æ˜¯ <strong>ä¸€è‡´</strong>
çš„ã€‚æ˜¾ç„¶ï¼Œ<code>Any</code>
æ˜¯ä¸è¶³ä»¥é‡‡ä¿¡çš„ã€‚å› æ­¤ï¼Œæˆ‘éœ€è¦å°†è¿™ä¸ªç±»å‹å‚æ•°åŒ–ï¼Œä»¥åšåˆ°ä¸¥è°¨çš„è¡¨è¾¾ã€‚</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">type</span> F<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> A <span class="op">=&gt;</span> A</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> <span class="kw">trait</span> X<span class="op">[</span>A<span class="op">]</span> <span class="kw">extends</span> <span class="op">(</span>X<span class="op">[</span>A<span class="op">]</span> <span class="op">=&gt;</span> A<span class="op">)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> <span class="kw">def</span> Y<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> F<span class="op">[</span>A<span class="op">])</span> <span class="op">=</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="kw">val</span> g<span class="op">:</span> X<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> x <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="fu">g</span><span class="op">(</span>g<span class="op">)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">// defined alias type F[A] = A =&gt; A</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">// defined trait X</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Y<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> F<span class="op">[</span>A<span class="op">]):</span> A</span></code></pre></div>
<p>è‡³æ­¤ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ„Ÿè§‰äº†ï¼ŸY Combinator
çš„å¥¥ä¹‰åœ¨äºï¼Œ<strong>å¯¹ã€Œè‡ªåº”ç”¨å‡½æ•°ã€ç±»å‹ <code>X</code>
çš„è‡ªåº”ç”¨</strong>ã€‚è¿™æ ·åšçš„ä»·å€¼ï¼Œä»ç¼–ç¨‹çš„è§’åº¦æ¥çœ‹ï¼Œå°±æ˜¯å®ç°äº†é€’å½’ï¼ˆå¾ªç¯ï¼‰ã€‚</p>
<p>æ²¡æƒ³é€šçš„è¯ï¼Œæˆ‘ä»¬å°±ä»¥é˜¶ä¹˜å‡½æ•°ä¸ºä¾‹éªŒè¯ä¸€ä¸‹ï¼š</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">def</span> fact<span class="op">:</span> <span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span> <span class="op">=</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> <span class="dv">1</span> <span class="op">=&gt;</span> <span class="dv">1</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> n <span class="op">=&gt;</span> n <span class="op">*</span> <span class="fu">fact</span><span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fact<span class="op">:</span> <span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">fact</span><span class="op">(</span><span class="dv">4</span><span class="op">)</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> res1<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">24</span></span></code></pre></div>
<p>å°†å…¶æ”¹å†™ä¸ºå¯¹ <code>Y</code> çš„åº”ç”¨ï¼š</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> fact <span class="op">=</span> Y<span class="op">[</span><span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span><span class="op">]:</span> f <span class="op">=&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="dv">1</span> <span class="op">=&gt;</span> <span class="dv">1</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> n <span class="op">=&gt;</span> n <span class="op">*</span> <span class="fu">f</span><span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span></code></pre></div>
<p>äºŒè€…åŒºåˆ«åœ¨äºï¼Œå‰è€…æ˜¯ç›´æ¥å¼•ç”¨è‡ªèº«ï¼Œåè€…çš„å‚æ•°æ˜¯è‡ªèº«çš„ä»£ç†ã€‚</p>
<blockquote>
<p>Iâ€™m my own granddadâ€¦</p>
</blockquote>
<p><cite>The Bartender, <strong><em>Predestination (2014)</em></strong>
<a href="#fn5" class="footnote-ref" id="fnref5"
role="doc-noteref"><sup>5</sup></a></cite></p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¹ˆæ”¹å†™ç¼–è¯‘å™¨æ˜¯æ‰›ä¸ä½çš„ï¼š</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> fact <span class="op">=</span> Y<span class="op">[</span><span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span><span class="op">]:</span> f <span class="op">=&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> <span class="dv">1</span> <span class="op">=&gt;</span> <span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> n <span class="op">=&gt;</span> n <span class="op">*</span> <span class="fu">f</span><span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>java<span class="op">.</span>lang<span class="op">.</span><span class="ex">StackOverflowError</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">...</span></span></code></pre></div>
<h2 id="æƒ°æ€§æ±‚å€¼">æƒ°æ€§æ±‚å€¼</h2>
<p>ä¸ºä»€ä¹ˆä¼šæ ˆæº¢å‡ºå‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜ç¡®å®ä¸å¥½è§£é‡Šï¼Œä¸å¦‚ä»è§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å»é€†å‘ç†è§£ã€‚</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">class</span> Lazy<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> <span class="op">()</span> <span class="op">=&gt;</span> A<span class="op">):</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="kw">def</span> eval<span class="op">:</span> A <span class="op">=</span> <span class="fu">f</span><span class="op">()</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">// defined class Lazy</span></span></code></pre></div>
<p>é¦–å…ˆï¼Œéœ€è¦å¼•å…¥ <code>Lazy</code> æ¥æ¨¡æ‹Ÿ <strong>æƒ°æ€§æ±‚å€¼</strong> <a
href="#fn6" class="footnote-ref" id="fnref6"
role="doc-noteref"><sup>6</sup></a>ã€‚å…¶æ¬¡ï¼Œå¯¹åº”åœ°è°ƒæ•´ <code>F</code>
<code>X</code> <code>Y</code> ï¼š</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">type</span> F<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> Lazy<span class="op">[</span>A<span class="op">]</span> <span class="op">=&gt;</span> A</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> <span class="kw">trait</span> X<span class="op">[</span>A<span class="op">]</span> <span class="kw">extends</span> <span class="op">(</span>X<span class="op">[</span>A<span class="op">]</span> <span class="op">=&gt;</span> Lazy<span class="op">[</span>A<span class="op">])</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> <span class="kw">def</span> Y<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> F<span class="op">[</span>A<span class="op">])</span> <span class="op">=</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="kw">val</span> g<span class="op">:</span> X<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> x <span class="op">=&gt;</span> Lazy<span class="op">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>     <span class="op">()</span> <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="fu">g</span><span class="op">(</span>g<span class="op">)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">// defined alias type F[A] = Lazy[A] =&gt; A</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">// defined trait X</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Y<span class="op">[</span>A<span class="op">](</span>f<span class="op">:</span> F<span class="op">[</span>A<span class="op">]):</span> Lazy<span class="op">[</span>A<span class="op">]</span></span></code></pre></div>
<p>æœ€åï¼Œè°ƒæ•´æ”¹å†™çš„ <code>fact</code>ï¼Œå›è½¦ï¼</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> fact <span class="op">=</span> Y<span class="op">[</span><span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span><span class="op">]:</span> f <span class="op">=&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> <span class="dv">1</span> <span class="op">=&gt;</span> <span class="dv">1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span>   <span class="cf">case</span> n <span class="op">=&gt;</span> n <span class="op">*</span> f<span class="op">.</span><span class="fu">eval</span><span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     <span class="op">|</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> fact<span class="op">:</span> Lazy<span class="op">[</span><span class="bu">Int</span> <span class="op">=&gt;</span> <span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> Lazy@<span class="dv">1</span>c23e369  </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> fact<span class="op">.</span><span class="fu">eval</span><span class="op">(</span><span class="dv">4</span><span class="op">)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> res2<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">24</span></span></code></pre></div>
<p>ä»ç»“æœæ¥çœ‹ï¼Œæ ˆæº¢å‡ºæ˜¯æ²¡æœ‰äº†ã€‚å…¶ä¸­çš„ç»†èŠ‚å°±åœ¨ <code>g</code> ï¼š</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode scala"><code class="sourceCode scala"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">// stack overflow</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> g<span class="op">:</span> X<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> x <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">// ok</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> g<span class="op">:</span> X<span class="op">[</span>A<span class="op">]</span> <span class="op">=</span> x <span class="op">=&gt;</span> Lazy<span class="op">:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">()</span> <span class="op">=&gt;</span> <span class="fu">f</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span>x<span class="op">))</span></span></code></pre></div>
<p>ä¸»æµç¼–ç¨‹è¯­è¨€å‡ ä¹éƒ½æ˜¯ <strong>ä¸¥æ ¼æ±‚å€¼</strong> çš„ï¼Œè¿™æ„å‘³ç€
<code>x(x)</code> ä¼šåœ¨ <strong>è‡ªåº”ç”¨</strong> ä¸­æ— é™å¾ªç¯ç›´åˆ°æ ˆæº¢å‡ºã€‚è€Œ
<code>Lazy</code> ç±»å‹çš„å¼•å…¥ï¼Œå°±è®© <strong>è‡ªåº”ç”¨</strong>
å¯æŒ‰éœ€ï¼ˆå»¶è¿Ÿï¼‰è°ƒç”¨ã€‚è¿™ä¸ªæŒ‰éœ€ï¼Œå°±ä½“ç°åœ¨ <code>f.eval(n - 1)</code>ã€‚</p>
<p>çœ¼å°–çš„ä½ ï¼Œå¯èƒ½å·²ç»å‘ç°äº†ï¼Œè¿™ä¸€æ­¥æ­¥å‰–æå¾—åˆ°çš„ä»£ç å’Œæœ€åˆç»™å‡ºçš„ç­”æ¡ˆä¸ä¸€æ ·å•Šã€‚å—¯ï¼Œæ˜¯ä¸ä¸€æ ·ï¼Œä½†æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä¸ä¿¡å°±è‡ªå·±å»è¯•è¯•å§ã€‚</p>
<h2 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h2>
<p>ç”±æ­¤å¯è§ï¼ŒY Combinator çš„å®è´¨æ˜¯ï¼Œåœ¨
<strong>å‘æœªæ¥å€Ÿä¸€ä¸ªã€Œä»£ç†ã€</strong> å•Šã€‚</p>
<p>ä¸æ‡‚ï¼Œæ²¡å…³ç³»ã€‚å¢™è£‚æ¨èè¿™éƒ¨ç”µå½±ï¼Œçœ‹è¿‡ä¹‹åå†æ¥ä½“ä¼š Y
Combinatorï¼Œå¿…å®šæ›´ç”ŸåŠ¨ã€‚</p>
<figure>
<img src="8a6de45ff1ff8d8ce9eb3e3364fe679b418c4110.jpg"
alt="å›¾ç‰‡æ¥è‡ª" />
<figcaption aria-hidden="true">å›¾ç‰‡æ¥è‡ª<a href="#fn7"
class="footnote-ref" id="fnref7"
role="doc-noteref"><sup>7</sup></a></figcaption>
</figure>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a
href="https://en.wikipedia.org/wiki/Fixed-point_combinator" class="uri"
target="_blank">https://en.wikipedia.org/wiki/Fixed-point_combinator</a><a
href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p><a
href="https://scastie.scala-lang.org/zhongl/inj6N2dpQ6eSB5xSAKwVlQ/28"
class="uri"
target="_blank">https://scastie.scala-lang.org/zhongl/inj6N2dpQ6eSB5xSAKwVlQ/28</a><a
href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p><a
href="https://juejin.cn/post/7043748080109223944#heading-16" class="uri"
target="_blank">https://juejin.cn/post/7043748080109223944#heading-16</a><a
href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>å‡ºè‡ªæˆ‘çš„ä¸ªäººå‘½åï¼Œå¯èƒ½ä¸ä¸¥è°¨ï¼Œæ‡‚æˆ‘æ„æ€å°±è¡Œã€‚<a
href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn5"><p><a
href="https://www.imdb.com/title/tt2397535/quotes/?item=qt4296558&amp;ref_=ext_shr_lnk"
class="uri"
target="_blank">https://www.imdb.com/title/tt2397535/quotes/?item=qt4296558&amp;ref_=ext_shr_lnk</a><a
href="#fnref5" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn6"><p><a
href="https://en.wikipedia.org/wiki/Lazy_evaluation#Simulating_laziness_in_eager_languages"
class="uri"
target="_blank">https://en.wikipedia.org/wiki/Lazy_evaluation#Simulating_laziness_in_eager_languages</a><a
href="#fnref6" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn7"><p><a
href="https://www.imdb.com/title/tt2397535/mediaviewer/rm2485654785/?ref_=tt_ov_i"
class="uri"
target="_blank">https://www.imdb.com/title/tt2397535/mediaviewer/rm2485654785/?ref_=tt_ov_i</a><a
href="#fnref7" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol>
</section>
<nav class="not-prose"><ul><li><a href="/post/#/plog"><span class="icons-outlined align-bottom">tag</span>ç å¿—</a></li></ul></nav><img class="mx-auto size-80 grayscale" src="/qrcode_wechat.jpg" /></article><footer><p><span>Â©</span>2025 zhongl.fun</p></footer></main></body></html>